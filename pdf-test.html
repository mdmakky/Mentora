<!DOCTYPE html>
<html>
<head>
    <title>PDF Viewer Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .pdf-container { margin: 20px 0; }
        iframe { border: 1px solid #ccc; }
        .document-card { 
            border: 1px solid #ddd; 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 5px; 
        }
    </style>
</head>
<body>
    <h1>PDF Viewer Test</h1>
    <p>Testing document viewing with fixed URLs...</p>
    
    <div id="documents-container">
        <p>Loading documents...</p>
    </div>

    <script>
        // Fetch documents and create test viewers
        fetch('http://localhost:8000/api/reader/documents/')
        .then(response => response.json())
        .then(data => {
            const container = document.getElementById('documents-container');
            container.innerHTML = '';
            
            const documents = data.documents || data;
            
            documents.forEach(doc => {
                const docDiv = document.createElement('div');
                docDiv.className = 'document-card';
                
                const fileUrl = `http://localhost:8000/api/reader/documents/${doc.id}/file/`;
                
                docDiv.innerHTML = `
                    <h3>${doc.title}</h3>
                    <p><strong>Pages:</strong> ${doc.total_pages} | <strong>Topics:</strong> ${doc.topics.slice(0,3).join(', ')}</p>
                    <p><strong>Direct PDF URL:</strong> <a href="${fileUrl}" target="_blank">${fileUrl}</a></p>
                    
                    <div class="pdf-container">
                        <h4>Embedded PDF Viewer:</h4>
                        <iframe src="${fileUrl}" width="800" height="600"></iframe>
                    </div>
                `;
                
                container.appendChild(docDiv);
            });
        })
        .catch(error => {
            console.error('Error:', error);
            document.getElementById('documents-container').innerHTML = 
                '<p style="color: red;">Error loading documents: ' + error.message + '</p>';
        });
    </script>
</body>
</html>
